---
layout: forums
title: 'Blocking dropped items?'
breadcrumbs:
 - "Plugin Development": "/forums/plugin-development.105/"
 - "Rust Development": "/forums/rust-development.4/"
---
<div class="titleBar">
    <h1>
        <a href="{{ '/threads/blocking-dropped-items.22650/' | prepend: site.baseurl }}">Blocking dropped items?</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/rust-development.4/' | prepend: site.baseurl }}">Rust Development</a>' started by <a class="username"
            dir="auto">Kappasaurus</a>, <a href="{{ '/threads/blocking-dropped-items.22650/' | prepend: site.baseurl }}"><span class="DateTime" title="Dec 25, 2016 at 4:17 AM">Dec 25, 2016</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-279107" class="message" data-author="Kappasaurus">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Kappasaurus" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Kappasaurus</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Is there any way from blocking item drop on death? I&#039;d like to avoid using ZoneManager for my Gun Game
                        plugin. We already have corpses. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Kappasaurus</a>,</span>
                        <a href="{{ '/threads/blocking-dropped-items.22650/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Dec 25, 2016 at 4:17 AM">Dec 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/blocking-dropped-items.22650/' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/279107/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-279214" class="message" data-author="sami37">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="sami37" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">sami37</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">By using GetHeldEntity() <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">sami37</a>,</span>
                        <a href="{{ '/threads/blocking-dropped-items.22650/#post-279214' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Dec 25, 2016 at 10:15 PM">Dec 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/blocking-dropped-items.22650/#post-279214' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/279214/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-279741" class="message" data-author="CombatTag">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="CombatTag" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">CombatTag</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Oxide has a hook for OnPlayerDie so you can manually handle the death. Here is an example of how I do it.<br />
                        <br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>        private object OnPlayerDie(BasePlayer player, HitInfo info)
        {
            if ((bool)player.GetType().GetMethod(&quot;WoundInsteadOfDying&quot;, BindingFlags.NonPublic | BindingFlags.Instance).Invoke(player, new object[] { info }) || player.IsDead()) return true;            Interface.CallHook(&quot;OnEntityDeath&quot;, player, info);            if (ConVar.Global.developer &gt; 1) Debug.Log(&quot;[Combat]&quot;.PadRight(10) + player.gameObject.name + &quot; died&quot;);            player.health = 0.0f;
            player.lifestate = BaseCombatEntity.LifeState.Dead;            using (TimeWarning.New(&quot;OnKilled&quot;, 0.1f))  player.OnKilled(info);            return true;
        }</pre>{% endraw %}
                        </div>Here are the relevant methods I looked at from the decompiled assembly code to create this method.<br />
                        <br /> In BasePlayer.cs<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>  public override void Die(HitInfo info = null)
  {
    using (TimeWarning.New(&quot;Player.Die&quot;, 0.1f))
    {
      if (this.IsDead())
        return;
      if (Interface.CallHook(&quot;OnPlayerDie&quot;, (object) this, (object) info) != null)
        return;
      if ((UnityEngine.Object) this.belt != (UnityEngine.Object) null)
        this.belt.DropActive(new UnityEngine.Vector3(UnityEngine.Random.Range(-2f, 2f), 0.2f, UnityEngine.Random.Range(-2f, 2f)).normalized * 3f);
      if (this.WoundInsteadOfDying(info))
        return;
      base.Die(info);
    }
  }</pre>{% endraw %}
                        </div>
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>  private bool WoundInsteadOfDying(HitInfo info)
  {
    if (this.IsWounded() || !this.EligibleForWounding(info))
      return false;
    this.lastWoundedTime = UnityEngine.Time.realtimeSinceStartup;
    this.health = (float) UnityEngine.Random.Range(2, 6);
    this.metabolism.bleeding.value = 0.0f;
    this.StartWounded();
    return true;
  }</pre>{% endraw %}
                        </div>BaseCombatEntity<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>  public virtual void Die(HitInfo info = null)
  {
    if (this.IsDead())
      return;
    Interface.CallHook(&quot;OnEntityDeath&quot;, (object) this, (object) info);
    if (ConVar.Global.developer &gt; 1)
      Debug.Log((object) (&quot;[Combat]&quot;.PadRight(10) + this.gameObject.name + &quot; died&quot;));
    this.health = 0.0f;
    this.lifestate = BaseCombatEntity.LifeState.Dead;
    using (TimeWarning.New(&quot;OnKilled&quot;, 0.1f))
      this.OnKilled(info);
  }</pre>{% endraw %}
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">CombatTag</a>,</span>
                        <a href="{{ '/threads/blocking-dropped-items.22650/#post-279741' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Dec 28, 2016 at 5:17 AM">Dec 28, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/blocking-dropped-items.22650/#post-279741' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/279741/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
</ol>
