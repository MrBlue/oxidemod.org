---
layout: forums
title: 'Solved - Getting the owner of a quarry?'
breadcrumbs:
 - "Plugin Development": "/forums/plugin-development.105/"
 - "Rust Development": "/forums/rust-development.4/"
---
<div class="titleBar">
    <h1>
        <span class="prefix prefixGreen">Solved</span> <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/' | prepend: site.baseurl }}">Getting the owner of a quarry?</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/rust-development.4/' | prepend: site.baseurl }}">Rust Development</a>' started by <a class="username"
            dir="auto">DylanSMR</a>, <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/' | prepend: site.baseurl }}"><span class="DateTime" title="Mar 9, 2016 at 11:57 PM">Mar 9,
                2016</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-186011" class="message" data-author="DylanSMR">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="DylanSMR" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">DylanSMR</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> So im creating something and I ran into a bit of trouble. How do I find the owner of a quarry when it gathers |
                        Code | <br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>        private void OnQuarryGather(MiningQuarry quarry, Item item)
        {
            item.amount = (item.amount * player.GetComponent&lt;pGather&gt;().GatherRate);
        }</pre>{% endraw %}
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">DylanSMR</a>,</span>
                        <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 9, 2016 at 11:57 PM">Mar 9, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/186011/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186013" class="message" data-author="Tuntenfisch">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Tuntenfisch" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Tuntenfisch</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> This should do the trick:<br /> This will only search for players which are on the server!<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>private void OnQuarryGather(MiningQuarry quarry, Item item)
{
    BasePlayer player = BasePlayer.FindByID(quarry.OwnerID);
}</pre>{% endraw %}
                        </div>The following will only search for sleeping players:<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>private void OnQuarryGather(MiningQuarry quarry, Item item)
{
    BasePlayer player = BasePlayer.FindSleeping(quarry.OwnerID);
}</pre>{% endraw %}
                        </div>There are some other functions with the purpose of finding a BasePlayer. Your best option is looking at the BasePlayer class inside the Assembly-CSharp.dll located in
                        <i>.../RustDedicated_Data/Managed</i> with a decompiler like <a href="http://www.telerik.com/products/decompiler.aspx" target="_blank" class="externalLink  rel="
                            nofollow">Telerik JustDecompiler free .NET decompiler</a>. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate"> Last edited by a moderator: <span class="DateTime" title="Mar 10, 2016 at 12:25 AM">Mar 10, 2016</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Tuntenfisch</a>,</span>
                        <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186013' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 10, 2016 at 12:13 AM">Mar 10, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186013' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/186013/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186019" class="message" data-author="DylanSMR">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="DylanSMR" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">DylanSMR</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Ah thanks!<br /> [DOUBLEPOST=1457569790][/DOUBLEPOST]Any way to search for both by chance? <div
                            class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">DylanSMR</a>,</span>
                        <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186019' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 10, 2016 at 12:24 AM">Mar 10, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186019' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/186019/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186022" class="message" data-author="Tuntenfisch">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Tuntenfisch" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Tuntenfisch</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="DylanSMR">
                            <aside>
                                <div class="attribution type">DylanSMR said: <a href="#post-186019" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Ah thanks!</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Keep in mind that OnQuarryGather(...) might be called quite often if multiple quarries are running on a server. Searching for the BasePlayer each time the hook is called
                        might not be the best option. Consider caching (saving) the BasePlayer or whatever else you need inside your plugin the first time the OnQuarryGather(...) hook is called.<br />
                        <br /> Something like this:<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>Dictionary&lt;ulong, BasePlayer&gt; quarryOwners = new Dictionary&lt;ulong, BasePlayer&gt;();private void OnQuarryGather(MiningQuarry quarry, Item item)
{
    BasePlayer player;
    if (!quarryOwners.TryGetValue(quarry.OwnerID, out player))
    {
        player = BasePlayer.FindByID(quarry.OwnerID) ?? BasePlayer.FindSleeping(quarry.OwnerID);
        quarryOwners[quarry.OwnerID] = player;
    }
    if (player == null) return;
    // do something
}</pre>{% endraw %}
                        </div>One more thing, though:<br /> I do not know whether the player will show up in one of the lists (active player list/sleeping player list) if he is logged off <b>and
                        </b>dead so you might need to go down a different route entirely. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate"> Last edited by a moderator: <span class="DateTime" title="Mar 10, 2016 at 12:52 AM">Mar 10, 2016</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Tuntenfisch</a>,</span>
                        <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186022' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 10, 2016 at 12:41 AM">Mar 10, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186022' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/186022/permalink">#4</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186029" class="message" data-author="DylanSMR">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="DylanSMR" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">DylanSMR</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Oh I see, thanks again <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}" class="mceSmilieSprite mceSmilie8" alt=":D"
                            title="Big Grin    :D" />
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">DylanSMR</a>,</span>
                        <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186029' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 10, 2016 at 1:11 AM">Mar 10, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/getting-the-owner-of-a-quarry.16518/#post-186029' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/186029/permalink">#5</a>
                </div>
            </div>
        </div>
    </li>
</ol>
