---
layout: forums
title: 'Solved - Invalid packet 51 (UI related)'
breadcrumbs:
 - "Game Discussion": "/categories/game-discussion.106/"
 - "Rust Discussion": "/forums/rust-discussion.23/"
---
<div class="titleBar">
    <h1>
        <span class="prefix prefixGreen">Solved</span> <a href="{{ '/threads/invalid-packet-51-ui-related.10196/' | prepend: site.baseurl }}">Invalid packet 51 (UI related)</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/rust-discussion.23/' | prepend: site.baseurl }}">Rust Discussion</a>' started by <a class="username"
            dir="auto">ownprox</a>, <a href="{{ '/threads/invalid-packet-51-ui-related.10196/' | prepend: site.baseurl }}"><span class="DateTime" title="Jul 13, 2015 at 8:31 PM">Jul 13,
                2015</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-108029" class="message" data-author="ownprox">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="ownprox" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ownprox</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>/76561200082745946/Ugly Fuck disconnecting: Invalid Raknet Packet 46
/76561200445525877/OwnProx disconnecting: Invalid Packet (51) 25b
/76561199952191901/Player77788423958162 disconnecting: Invalid Packet (51) 25b
/76561198083123737/PayneKillerâ„¢ disconnecting: Invalid Packet (51) 25b
/76561200191290422/Ivek disconnecting: Invalid Packet (51) 25b</pre>{% endraw %}
                        </div>anyone else experiencing this every 2 hours or so ? could this be down to the clan scrip thats public ? if so ill make one because the ppl who dced where in my clan but
                        its only rare, and 7 remained online when it happend <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate"> Last edited by a moderator: <span class="DateTime" title="Jul 14, 2015 at 1:34 AM">Jul 14, 2015</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ownprox</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 13, 2015 at 8:31 PM">Jul 13, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108029/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108095" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Have you tested without your GUI plugins? <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108095' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 1:17 AM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108095' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108095/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108107" class="message" data-author="ownprox">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="ownprox" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ownprox</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> the thing is im sure i had this before then really randomly and the fact it only dced my clan members is weird,
                        and my gui only updates on a player logging in or out and that dint happend we all just got dced and noone logged out or in for atleast 10 mins prior to it but i will dig
                        deeper see what i come up with my best guess is the clan script due to only my clan members getting dced and me at that exact moment out of 12 online 5 of us got dced who all
                        happend to be in the same clan so idk but i did first think it was the gui,<br />
                        <br /> thanks for the advice, i guess i can wait to see if other people experience this with the plugin but i highly dout its that<br />
                        <br />
                        <br /> also while your around i found a function and hooked it is it possible to get it released in oxide public so i can release a plugin due to people brute forcing players
                        codelocks with some sort of network modifications sending 100s of codes a second or so i can tell you the function name but i haven&#039;t finished testing yet so i don&#039;t
                        know if its required just wondering if its possible to get it published in oxide&#039;s update<br />
                        <br /> heres the function that im using the patcher to patch in oxide<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>
private void UnlockWithCode(BaseEntity.RPCMessage rpc)
{
    if (Interface.CallHook(&quot;OnUnlockWithCode&quot;, new object[]
    {
        rpc
    }) != null)
    {
        return;
    }
    string a = rpc.read.String();
    if (!base.IsLocked())
    {
        return;
    }
    if (a != this.code)
    {
        this.DoEffect(this.effectDenied);
        rpc.player.Hurt(1f, DamageType.ElectricShock, this, true);
        return;
    }
</pre>{% endraw %}
                        </div>also on this note just wondering if there&#039;s a way i can move my hook under the if (a != this.code) <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ownprox</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108107' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 1:32 AM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108107' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108107/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108133" class="message" data-author="Hatemail">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Hatemail" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Hatemail</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="ownprox">
                            <aside>
                                <div class="attribution type">ownprox said: <a href="#post-108107" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">the thing is im sure i had this before then really randomly and the fact it only dced my clan members is weird, and my gui only updates on a
                                        player logging in or out and that dint happend we all just got dced and noone logged out or in for atleast 10 mins prior to it but i will dig deeper see what i
                                        come up with my best guess is the clan script due to only my clan members getting dced and me at that exact moment out of 12 online 5 of us got dced who all
                                        happend to be in the same clan so idk but i did first think it was the gui,<br />
                                        <br /> thanks for the advice, i guess i can wait to see if other people experience this with the plugin but i highly dout its that<br />
                                        <br />
                                        <br /> also while your around i found a function and hooked it is it possible to get it released in oxide public so i can release a plugin due to people brute
                                        forcing players codelocks with some sort of network modifications sending 100s of codes a second or so i can tell you the function name but i haven&#039;t
                                        finished testing yet so i don&#039;t know if its required just wondering if its possible to get it published in oxide&#039;s update<br />
                                        <br /> heres the function that im using the patcher to patch in oxide<br />
                                        <div class="bbCodeBlock bbCodeCode">
                                            <div class="type">Code:</div>
                                            {% raw %}<pre>
private void UnlockWithCode(BaseEntity.RPCMessage rpc)
{
    if (Interface.CallHook(&quot;OnUnlockWithCode&quot;, new object[]
    {
        rpc
    }) != null)
    {
        return;
    }
    string a = rpc.read.String();
    if (!base.IsLocked())
    {
        return;
    }
    if (a != this.code)
    {
        this.DoEffect(this.effectDenied);
        rpc.player.Hurt(1f, DamageType.ElectricShock, this, true);
        return;
    }
</pre>{% endraw %}
                                        </div>also on this note just wondering if there&#039;s a way i can move my hook under the if (a != this.code)
                                    </div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Move the injection index down. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Hatemail</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108133' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 2:52 AM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108133' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108133/permalink">#4</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108145" class="message" data-author="ownprox">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="ownprox" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ownprox</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Hatemail">
                            <aside>
                                <div class="attribution type">Hatemail said: <a href="#post-108133" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Move the injection index down.</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>thanks mate dint think of that.<br /> [DOUBLEPOST=1436906316,1436841873][/DOUBLEPOST]is it possible to hook a function in 2 different places ? from what i can see its
                        not, this would be very handy to have <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ownprox</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108145' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 9:38 PM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108145' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108145/permalink">#5</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108432" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="ownprox">
                            <aside>
                                <div class="attribution type">ownprox said: <a href="#post-108145" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">thanks mate dint think of that.<br /> [DOUBLEPOST=1436906316,1436841873][/DOUBLEPOST]is it possible to hook a function in 2 different places ?
                                        from what i can see its not, this would be very handy to have</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Yes, there are 3 or 4 existing hooks that do this. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108432' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 11:05 PM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108432' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108432/permalink">#6</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108436" class="message" data-author="ownprox">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="ownprox" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ownprox</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> as you can see i have 1 hook already but cant find a way to add another in the same function<br />
                        <a href="http://gyazo.com/eae5ebf6b9e7e67dc281e80026a92bca" target="_blank" class="externalLink" rel="nofollow">http://gyazo.com/eae5ebf6b9e7e67dc281e80026a92bca</a>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ownprox</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108436' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 11:42 PM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108436' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108436/permalink">#7</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108441" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="ownprox">
                            <aside>
                                <div class="attribution type">ownprox said: <a href="#post-108436" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">as you can see i have 1 hook already but cant find a way to add another in the same function<br />
                                        <a href="http://gyazo.com/eae5ebf6b9e7e67dc281e80026a92bca" target="_blank" class="externalLink">http://gyazo.com/eae5ebf6b9e7e67dc281e80026a92bca</a></div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Hit the Clone button. <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}" class="mceSmilieSprite mceSmilie2" alt=";)" title="Wink    ;)" />
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108441' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 11:56 PM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108441' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108441/permalink">#8</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-108444" class="message" data-author="ownprox">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="ownprox" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">ownprox</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Wulf">
                            <aside>
                                <div class="attribution type">Wulf said: <a href="#post-108441" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Hit the Clone button. <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}" class="mceSmilieSprite mceSmilie2" alt=";)" title="Wink    ;)" /></div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Legend thanks.<br />
                        <br /> and yeah i can confirm that the dc issue was to do with players online gui i made a public update i think it was a issue sending the gui to the player that just logged
                        out because when the ondisconnect is called the player is still in activePlayerList so i just did a simple filter hopefully it fix&#039;s it. <div class="messageTextEndMarker">
                            &nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">ownprox</a>,</span>
                        <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108444' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 14, 2015 at 11:58 PM">Jul 14, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/invalid-packet-51-ui-related.10196/#post-108444' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/108444/permalink">#9</a>
                </div>
            </div>
        </div>
    </li>
</ol>
