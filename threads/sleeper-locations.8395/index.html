---
layout: forums
title: 'Rust Legacy - Sleeper locations'
breadcrumbs:
 - "Plugin Requests": "/forums/plugin-requests.10/"
---
<div class="titleBar">
    <h1>
        <span class="prefix prefixOrange">Rust Legacy</span> <a href="{{ '/threads/sleeper-locations.8395/' | prepend: site.baseurl }}">Sleeper locations</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/plugin-requests.10/' | prepend: site.baseurl }}">Plugin Requests</a>' started by <a class="username"
            dir="auto">MrPrzyr</a>, <a href="{{ '/threads/sleeper-locations.8395/' | prepend: site.baseurl }}"><span class="DateTime" title="May 12, 2015 at 7:55 AM">May 12, 2015</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-87997" class="message" data-author="MrPrzyr">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="MrPrzyr" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">MrPrzyr</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> As the Oxide 1.18 plugin: <a href="http://oxidemod.org/resources/sleepers-location-prod.501/"
                            class="internalLink">http://oxidemod.org/resources/sleepers-location-prod.501/</a><br />
                        <br /> I think it is a lot useful and should be ported to the Oxide 2.0 =p <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">MrPrzyr</a>,</span>
                        <a href="{{ '/threads/sleeper-locations.8395/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime" title="May 12, 2015 at 7:55 AM">May
                                12, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/sleeper-locations.8395/' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/87997/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-88892" class="message" data-author="mvrb">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="mvrb" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">mvrb</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> I agree, I was going to suggest this too. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">mvrb</a>,</span>
                        <a href="{{ '/threads/sleeper-locations.8395/#post-88892' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="May 15, 2015 at 9:48 AM">May 15, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/sleeper-locations.8395/#post-88892' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/88892/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-99810" class="message" data-author="mvrb">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="mvrb" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">mvrb</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Hey, I have a shitty solution for you:<br />
                        <br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>PLUGIN.Title = &quot;Sleepers&quot;
PLUGIN.Description = &quot;Saves sleeper locations&quot;
PLUGIN.Author = &quot;mvrb&quot;
PLUGIN.Version      = V(1, 0, 0)
PLUGIN.ResourceId   = _function PLUGIN:Init()
    -----------------------------
    -- Chat Commands
    -----------------------------
   
    command.AddChatCommand(&quot;sleeper&quot;, self.Object, &quot;cmdSleepers&quot;)
    command.AddChatCommand(&quot;sleepers&quot;, self.Object, &quot;cmdSleepers&quot;)
    command.AddChatCommand(&quot;s&quot;, self.Object, &quot;cmdSleepers&quot;)
   
    -----------------------------
    -- Variables
    -----------------------------
   
    -- ChatName
    CN = &quot;YourServerName&quot;   
   
    -- Sleepers
    self.sleepers = {}   
end-----------------------------
-- Custom Functions
-----------------------------
function PLUGIN:cmdSleepers( netuser, cmd )   
    if(netuser:CanAdmin()) then
        if (#self.sleepers &gt; 0) then
            rust.SendChatMessage(netuser, CN, &quot;--- start ---&quot;)
            local i = 1
            while (self.sleepers[i]) do
                rust.SendChatMessage(netuser, self.sleepers[i][&quot;name&quot;], self.sleepers[i][&quot;msg&quot;])
                i = i + 1
            end
            rust.SendChatMessage(netuser, CN, &quot;--- end ---&quot;)
        else -- No players have disconnected
            rust.SendChatMessage(netuser, CN, &quot;[color #FF3D0D]No players have disconnected in the current session.&quot;)
        end
    end
end
function PLUGIN:AddSleeper( name, msg)
    local insert = {}
    insert[&quot;name&quot;] = name
    insert[&quot;msg&quot;] = msg
    table.insert(self.sleepers, insert)
end-----------------------------
-- AutoFunctions
-----------------------------
function PLUGIN:OnPlayerDisconnected(networkplayer)
    local netuser     = networkplayer:GetLocalData()
    local name         = netuser.displayName
    local position     = netuser.playerClient.lastKnownPosition
   
    if (#self.sleepers == 20) then    table.remove(self.sleepers, 1)    end -- Remove last line if 20
    if(position.x ~= 0 and position.y ~= 0 and position.z ~= 0) then
        self:AddSleeper(netuser.displayName, math.ceil(position.x) .. &quot; || &quot; .. math.ceil(position.y) .. &quot; || &quot; .. math.ceil(position.z) .. &quot; ||&quot;)   
        print(netuser.displayName .. &quot; disconnected here: teleport.topos mvrb &quot; .. math.ceil(position.x) .. &quot; &quot; .. math.ceil(position.y) .. &quot; &quot; .. math.ceil(position.z))
    end
end</pre>{% endraw %}
                        </div>Players coordinates are added to /s or /sleepers. It will display the last 20 disconnected users, but it doesn&#039;t save it to a file so you can find a sleeper&#039;s
                        location by name.<br />
                        <br /> It will print it to the console though, so you could go through the logs and search for the last disconnect of a player.<br />
                        <br /> Save the code as &#039;sleepers.lua&#039;. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">mvrb</a>,</span>
                        <a href="{{ '/threads/sleeper-locations.8395/#post-99810' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jun 16, 2015 at 3:00 PM">Jun 16, 2015</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/sleeper-locations.8395/#post-99810' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/99810/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
</ol>
