---
layout: forums
title: 'Check if player connected and give role in discord.'
breadcrumbs:
 - "Plugin Development": "/forums/plugin-development.105/"
 - "Rust Development": "/forums/rust-development.4/"
---
<div class="titleBar">
    <h1>
        <a href="{{ '/threads/check-if-player-connected-and-give-role-in-discord.31582/' | prepend: site.baseurl }}">Check if player connected and give role in discord.</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/rust-development.4/' | prepend: site.baseurl }}">Rust Development</a>' started by <a class="username"
            dir="auto">BattleSheep</a>, <a href="{{ '/threads/check-if-player-connected-and-give-role-in-discord.31582/' | prepend: site.baseurl }}"><span class="DateTime"
                title="Aug 23, 2018 at 10:02 PM">Aug 23, 2018</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-412870" class="message" data-author="BattleSheep">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="BattleSheep" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">BattleSheep</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">Hey Guys.<br /> I have modified the Rustcord Plugin.<br /> In Discord we have a channel to authorize players that
                        they are on the discord server.<br /> Works... but... The user can authorize any player endless times. My Idea is now.<br />
                        <ul>
                            <li>The User types: !auth {hisSteamID}</li>
                            <li>Check if the Player or the SteamID is connected.</li>
                            <li>Maybe generate a Random TAN that ist send to the player with the SteamID or in Discord.</li>
                            <li>And now the player has repeat the TAN in the Game or Discord.</li>
                            <li>Or give the player a new role in discord after the !auth command that the Channel is not Visible with the new Rank/Role.</li>
                        </ul>My Code is at the Time very simple (i mean my &quot;edit&quot;)<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>        private void DiscordToGameCmd(string command, string param, User author, string channelid)
        {
            if (command == &quot;players&quot;)
            {
                string listStr = string.Empty;
                var pList = BasePlayer.activePlayerList;
                int i = 0;
                foreach (var player in pList)
                {
                    listStr += player.displayName + &quot; [&quot; + ++i + &quot;]&quot;;
                    if (i != pList.Count)
                        listStr += &quot;\n&quot;;
                }
                Channel.GetChannel(_client, channelid, chan =&gt;
                {
                    // Connected Players [{count}/{maxplayers}]: {playerslist}
                    chan.CreateMessage(_client, Translate(&quot;Discord_PlayersResponse&quot;, new Dictionary&lt;string, string&gt;
                    {
                        { &quot;count&quot;, Convert.ToString(BasePlayer.activePlayerList.Count) },
                        { &quot;maxplayers&quot;, Convert.ToString(ConVar.Server.maxplayers) },
                        { &quot;playerslist&quot;, listStr }
                    }));
                });
            }
             if (command == &quot;auth&quot;)
            {
                ConsoleSystem.Run(ConsoleSystem.Option.Server.Quiet(), &quot;o.usergroup add &quot; + param + &quot; discord&quot; );
              
            }
        }</pre>{% endraw %}
                        </div>I use the Discord Extension from &quot;PsychoTea?&quot; and Dylan<br />
                        <br /> Is there a Site where i finde some discord functions like CreateMessage(); ?<br />
                        <br /> Or have someone another idea how i can control that a user only can use the auth command once.<br />
                        <br />
                        <br /> Thanks for your help <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}" class="mceSmilieSprite mceSmilie1" alt=":)" title="Smile    :)" /><br />
                        <br />
                        <br />
                        <br /> Offtopic: Someone know if the ai npc aimcone is more accurate if i put it higher or lower? <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">BattleSheep</a>,</span>
                        <a href="{{ '/threads/check-if-player-connected-and-give-role-in-discord.31582/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Aug 23, 2018 at 10:02 PM">Aug 23, 2018</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/check-if-player-connected-and-give-role-in-discord.31582/' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/412870/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
</ol>
