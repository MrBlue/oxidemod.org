---
layout: forums
title: 'Failed to call hook (When player dies with a beartrap)'
breadcrumbs:
 - "Plugin Development": "/forums/plugin-development.105/"
 - "Rust Development": "/forums/rust-development.4/"
---
<div class="titleBar">
    <h1>
        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/' | prepend: site.baseurl }}">Failed to call hook (When player dies with a beartrap)</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/rust-development.4/' | prepend: site.baseurl }}">Rust Development</a>' started by <a class="username"
            dir="auto">TheMechanical97</a>, <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/' | prepend: site.baseurl }}"><span class="DateTime"
                title="Jan 25, 2016 at 10:47 PM">Jan 25, 2016</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-168762" class="message" data-author="TheMechanical97">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="TheMechanical97" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">TheMechanical97</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>[Oxide] 11:21 PM [Error] Failed to call hook 'OnEventPlayerDeath' on plugin 'LastManStanding v1.1.1' (NullReferenceException: Object reference not set to an instance of an object)
[Oxide] 11:21 PM [Debug]   at Oxide.Plugins.LastManStanding.OnEventPlayerDeath (.BasePlayer victim, .HitInfo hitinfo) [0x00000] in &lt;filename unknown&gt;:0  at Oxide.Plugins.LastManStanding.DirectCallHook (System.String name, System.Object&amp; ret, System.Object[] args) [0x00000] in &lt;filename unknown&gt;:0  at Oxide.Plugins.CSharpPlugin.InvokeMethod (System.Reflection.MethodInfo method, System.Object[] args) [0x00000] in &lt;filename unknown&gt;:0  at Oxide.Core.Plugins.CSPlugin.OnCallHook (System.String name, System.Object[] args) [0x00000] in &lt;filename unknown&gt;:0  at Oxide.Core.Plugins.Plugin.CallHook (System.String hookname, System.Object[] args) [0x00000] in &lt;filename unknown&gt;:0</pre>{% endraw %}
                        </div>[DOUBLEPOST=1453762065][/DOUBLEPOST]Thats the code from:<br />
                        <br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>void OnEventPlayerDeath(BasePlayer victim, HitInfo hitinfo)
        {
            var attacker = hitinfo?.Initiator as BasePlayer;
            ulong attackerID = attacker.userID;
            var PlayersLeft = LMSPlayers.Count;
            if (useThisEventLMS)
            {
                adddeathsstats(victim);
                addkillstats(attacker);
                EventManager.Call(&quot;LeaveEvent&quot;, victim);
                MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;eventDeath&quot;, this), victim.displayName));
                if (LMSPlayers.Count &lt;= 1)
                {
                    addKillPoints(attacker);
                    Winner(attacker);
                    return;
                }
                //addSurvivalPoints();
                MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;playersremaining&quot;, this), PlayersLeft.ToString()));
            }
        }</pre>{% endraw %}
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">TheMechanical97</a>,</span>
                        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jan 25, 2016 at 10:47 PM">Jan 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/168762/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-168764" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> You&#039;d need to check if the attacker is null. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168764' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span
                                class="DateTime" title="Jan 25, 2016 at 10:50 PM">Jan 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168764' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/168764/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-168772" class="message" data-author="TheMechanical97">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="TheMechanical97" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">TheMechanical97</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> how??<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>if (attacker == null)
{
    false
}
true</pre>{% endraw %}
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">TheMechanical97</a>,</span>
                        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168772' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span
                                class="DateTime" title="Jan 25, 2016 at 11:00 PM">Jan 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168772' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/168772/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-168773" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="TheMechanical97">
                            <aside>
                                <div class="attribution type">TheMechanical97 said: <a href="#post-168772" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">how??<br />
                                        <div class="bbCodeBlock bbCodeCode">
                                            <div class="type">Code:</div>
                                            {% raw %}<pre>if (attacker == null)
{
    false
}
true</pre>{% endraw %}
                                        </div>
                                    </div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Pretty much just check null before your code that deals with the attacker. If the code is all about the attacker, just check for null and return before the relevant code.
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168773' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span
                                class="DateTime" title="Jan 25, 2016 at 11:00 PM">Jan 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168773' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/168773/permalink">#4</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-168776" class="message" data-author="TheMechanical97">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="TheMechanical97" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">TheMechanical97</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Seems not working :C<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>void OnEventPlayerDeath(BasePlayer victim, HitInfo hitinfo)
        {
            var attacker = hitinfo?.Initiator as BasePlayer;
            ulong attackerID = attacker.userID;
            var PlayersLeft = LMSPlayers.Count;
            if (useThisEventLMS)
            {
                adddeathsstats(victim);
                if (attacker == null)
                {
                    addkillstats(attacker);
                    EventManager.Call(&quot;LeaveEvent&quot;, victim);
                    MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;eventDeath&quot;, this), victim.displayName));
                    if (LMSPlayers.Count &lt;= 1)
                    {
                        addKillPoints(attacker);
                        Winner(attacker);
                        return;
                    }
                    //addSurvivalPoints();
                    MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;playersremaining&quot;, this), PlayersLeft.ToString()));
                }
                EventManager.Call(&quot;LeaveEvent&quot;, victim);
                MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;eventDeath&quot;, this), victim.displayName));
                MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;playersremaining&quot;, this), PlayersLeft.ToString()));
            }
        }</pre>{% endraw %}
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">TheMechanical97</a>,</span>
                        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168776' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span
                                class="DateTime" title="Jan 25, 2016 at 11:06 PM">Jan 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168776' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/168776/permalink">#5</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-168779" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="TheMechanical97">
                            <aside>
                                <div class="attribution type">TheMechanical97 said: <a href="#post-168776" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Seems not working :C<br />
                                        <div class="bbCodeBlock bbCodeCode">
                                            <div class="type">Code:</div>
                                            {% raw %}<pre>void OnEventPlayerDeath(BasePlayer victim, HitInfo hitinfo)
        {
            var attacker = hitinfo?.Initiator as BasePlayer;
            ulong attackerID = attacker.userID;
            var PlayersLeft = LMSPlayers.Count;
            if (useThisEventLMS)
            {
                adddeathsstats(victim);
                if (attacker == null)
                {
                    addkillstats(attacker);
                    EventManager.Call(&quot;LeaveEvent&quot;, victim);
                    MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;eventDeath&quot;, this), victim.displayName));
                    if (LMSPlayers.Count &lt;= 1)
                    {
                        addKillPoints(attacker);
                        Winner(attacker);
                        return;
                    }
                    //addSurvivalPoints();
                    MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;playersremaining&quot;, this), PlayersLeft.ToString()));
                }
                EventManager.Call(&quot;LeaveEvent&quot;, victim);
                MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;eventDeath&quot;, this), victim.displayName));
                MessageAllPlayers(string.Format(lang.GetMessage(&quot;title&quot;, this) + lang.GetMessage(&quot;playersremaining&quot;, this), PlayersLeft.ToString()));
            }
        }</pre>{% endraw %}
                                        </div>
                                    </div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>You&#039;ve got it reversed. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168779' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span
                                class="DateTime" title="Jan 25, 2016 at 11:10 PM">Jan 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168779' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/168779/permalink">#6</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-168782" class="message" data-author="TheMechanical97">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="TheMechanical97" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">TheMechanical97</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Uh, gg for me D: <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">TheMechanical97</a>,</span>
                        <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168782' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span
                                class="DateTime" title="Jan 25, 2016 at 11:21 PM">Jan 25, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/failed-to-call-hook-when-player-dies-with-a-beartrap.15098/#post-168782' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/168782/permalink">#7</a>
                </div>
            </div>
        </div>
    </li>
</ol>
