---
layout: forums
title: 'Setting a weapon&#039;s ammo type and amount?'
breadcrumbs:
 - "Plugin Development": "/forums/plugin-development.105/"
 - "Rust Development": "/forums/rust-development.4/"
---
<div class="titleBar">
    <h1>
        <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/' | prepend: site.baseurl }}">Setting a weapon&#039;s ammo type and amount?</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/rust-development.4/' | prepend: site.baseurl }}">Rust Development</a>' started by <a class="username"
            dir="auto">isuelt</a>, <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/' | prepend: site.baseurl }}"><span class="DateTime" title="Mar 12, 2016 at 6:29 PM">Mar 12,
                2016</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-186749" class="message" data-author="isuelt">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="isuelt" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">isuelt</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Can someone help me here. I store a player&#039;s weapon ammo type and amount and then try to restore it, but it
                        fails. If the weapon has NO amount it gets restored with the base ammo amount, not the amount I stored.<br /> Is this code:<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>
var weapon = item.GetHeldEntity() as BaseProjectile;
                if (weapon != null)
                {
                    var ammoType = ItemManager.FindItemDefinition(storedItem.ammo);
                    if (ammoType != null) {
                        weapon.primaryMagazine.ammoType = ammoType;
                        weapon.primaryMagazine.contents = storedItem.ammoamount;
                        (item.GetHeldEntity() as BaseProjectile).primaryMagazine.contents = storedItem.ammoamount;
                        (item.GetHeldEntity() as BaseProjectile).primaryMagazine.ammoType = ammoType;
                    }
                }
                item.MoveToContainer(loot.inventory, storedItem.slot);</pre>{% endraw %}
                        </div>the same as the LUA version<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>if item.ammo then
            local magazine = itemEntity:GetHeldEntity().primaryMagazine
            local itemDef = global.ItemManager.FindItemDefinition.methodarray[1]:Invoke(nil, util.TableToArray({item.ammo.name}))
            magazine.ammoType = itemDef
            magazine.contents = item.ammo.amount
        end
        -- Set that created inventory item to player
        player.inventory:GiveItem(itemEntity, Inventory[slot])</pre>{% endraw %}
                        </div>Thanks in advance ! <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">isuelt</a>,</span>
                        <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 12, 2016 at 6:29 PM">Mar 12, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/186749/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186803" class="message" data-author="DylanSMR">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="DylanSMR" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">DylanSMR</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> May I see how your saving the data? That might be the problem here. <div class="messageTextEndMarker">&nbsp;
                        </div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">DylanSMR</a>,</span>
                        <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186803' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 12, 2016 at 9:04 PM">Mar 12, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186803' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/186803/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186868" class="message" data-author="isuelt">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="isuelt" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">isuelt</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="DylanSMR">
                            <aside>
                                <div class="attribution type">DylanSMR said: <a href="#post-186803" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">May I see how your saving the data? That might be the problem here.</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>class storedItem
        {
            public int amount;
            public int skinid;
            public int slot;
            public int itemid;
            public string shortname;
            public string ammo;
            public int ammoamount;
            public bool blueprint;
            public string durability;
            public Dictionary&lt;int, string&gt; attachments = new Dictionary&lt;int, string&gt;();
           
        }</pre>{% endraw %}
                        </div>
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">isuelt</a>,</span>
                        <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186868' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 13, 2016 at 1:37 AM">Mar 13, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186868' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/186868/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186870" class="message" data-author="DylanSMR">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="DylanSMR" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">DylanSMR</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Is this saving per player, or is it server wide? <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">DylanSMR</a>,</span>
                        <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186870' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 13, 2016 at 1:41 AM">Mar 13, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186870' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/186870/permalink">#4</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-186874" class="message" data-author="k1lly0u">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="k1lly0u" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">k1lly0u</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Perhaps I am misunderstanding the question but it seems you are kind of contradicting yourself here, you say if
                        the weapon has no ammo it gets restored to the default rust amount. If it has no ammo what are you storing? Are you trying to save a value of 0?<br />
                        <br /> A good example of exactly what you are trying to do I wrote in the latest EventManager update. Perhaps looking through it may help you with your issue <div
                            class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">k1lly0u</a>,</span>
                        <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186874' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Mar 13, 2016 at 1:55 AM">Mar 13, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/setting-a-weapons-ammo-type-and-amount.16577/#post-186874' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/186874/permalink">#5</a>
                </div>
            </div>
        </div>
    </li>
</ol>
