---
layout: forums
title: 'Solved - Prevent looting *some* items from inventories'
breadcrumbs:
 - "Plugin Development": "/forums/plugin-development.105/"
 - "Rust Development": "/forums/rust-development.4/"
---
<div class="titleBar">
    <h1>
        <span class="prefix prefixGreen">Solved</span> <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/' | prepend: site.baseurl }}">Prevent looting *some* items from
            inventories</a>
    </h1>
    <p id="pageDescription" class="muted">Discussion in '<a href="{{ '/forums/rust-development.4/' | prepend: site.baseurl }}">Rust Development</a>' started by <a class="username"
            dir="auto">Yatta</a>, <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/' | prepend: site.baseurl }}"><span class="DateTime" title="Jul 17, 2016 at 6:15 PM">Jul 17,
                2016</span></a>.
    </p>
</div>
<ol class="messageList" id="messageList">
    <li id="post-231646" class="message" data-author="Yatta">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Yatta" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Yatta</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Hey, im trying to set up a system that allows to open and look at a storage content, but <b>prevent players from
                            actually grabbing / splitting / consuming *some* items inside that storage</b>.<br />
                        <br /> I have the list of items I want to &quot;lock&quot; and can identify which item is being grabbed from the container. However thing get real messy when spliting : it
                        calls both the split and take events, im not sure you can figure out what are both the origin and destination containers, and you can split from the storage to your inventory
                        and also within the storage. <br />
                        <br /> So far I only achieved to prevent direct &quot;take full stack&quot; from the storage (by creating a new item equal to what has been taken, puting it back in the storage
                        and destroying the taken item), but as soon as spliting is involved its a mess (duplicates, items disappearing / reappearing). <br />
                        <br />
                        <b>Is there a clean way to lock some specific items in their containers ?</b><br />
                        <br /> Bonus question : <b>Is there a way to make sure the client view of a container is up to date ?</b><br />
                        <br /> thanks in advance <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Yatta</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 17, 2016 at 6:15 PM">Jul 17, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/' | prepend: site.baseurl }}" title="Permalink" class="item muted postNumber hashPermalink OverlayTrigger"
                        data-href="posts/231646/permalink">#1</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-231678" class="message" data-author="Yatta">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Yatta" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Yatta</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> btw theres a mixup in the Rust API doc, OnItemSplit has the same description as OnItemUpgrade :<br />
                        <div class="bbCodeBlock bbCodeCode">
                            <div class="type">Code:</div>
                            {% raw %}<pre>OnItemSplit
   * Called right before an item is upgraded
   * No return behavior
</pre>{% endraw %}
                        </div>And a second bonus question : Is there a way to know which container the split item comes from, and which container it is dropped in / or get information on result of the
                        split (created item, split successfull ...) ? <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="editDate"> Last edited by a moderator: <span class="DateTime" title="Jul 17, 2016 at 8:04 PM">Jul 17, 2016</span>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Yatta</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231678' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 17, 2016 at 7:42 PM">Jul 17, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231678' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/231678/permalink">#2</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-231773" class="message" data-author="Shady757">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Shady757" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Shady757</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Couldn&#039;t you just use OnItemRemovedFromContainer then use a NextTick to move it back to the container it was
                        moved from? I think I have a code example of this still, if you need it. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Shady757</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231773' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 17, 2016 at 11:02 PM">Jul 17, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231773' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/231773/permalink">#3</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-231785" class="message" data-author="Yatta">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Yatta" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Yatta</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <b>Fixed !<br />
                        </b><br /> Its not as easy as it sound because you have various cases that dont use the same mechanics :<br /> - Take full stack<br /> - Take full stack and put it in another
                        stack<br /> - Split a stack to an empty slot<br /> - Split a stack to another stack<br /> - Put full/partial stack onto belt empty slot/stack<br /> Plus :<br /> - Split event
                        doesnt tell you if the split succeeded (if you&#039;re trying to split onto a full stack and such) so you dont actually know if/how much of something was removed<br /> - Split
                        event doesnt tell you where the result is dropped<br /> - Split event doesnt trigger an AddToContainer event when the result is dropped on an existing stack<br /> - There is no
                        event (that i know of) for when a player add an ammount of item onto a stack<br /> - You cant cancel a split event (with a return true)<br />
                        <br /> And other fun particularities I dont remember right now.<br />
                        <br /> In the end I had to rely on something rather dirty to manage the stack splits : I send a kind of &quot;warning&quot; to nearby players telling them &quot;if in the next
                        split second you get a bigger ammount of that item, that mean you took it from here and you werent supposed to, so discard it&quot;. <div class="messageTextEndMarker">&nbsp;
                        </div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Yatta</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231785' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 17, 2016 at 11:53 PM">Jul 17, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231785' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/231785/permalink">#4</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-231837" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Yatta">
                            <aside>
                                <div class="attribution type">Yatta said: <a href="#post-231678" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">btw theres a mixup in the Rust API doc, OnItemSplit has the same description as OnItemUpgrade :<br />
                                        <div class="bbCodeBlock bbCodeCode">
                                            <div class="type">Code:</div>
                                            {% raw %}<pre>OnItemSplit
   * Called right before an item is upgraded
   * No return behavior
</pre>{% endraw %}
                                        </div>
                                    </div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Fixed that, thanks. <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}" class="mceSmilieSprite mceSmilie1" alt=":)" title="Smile    :)" />
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231837' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 18, 2016 at 2:35 AM">Jul 18, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-231837' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/231837/permalink">#5</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-232607" class="message" data-author="Yatta">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Yatta" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Yatta</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> Hey, just a little heads to Wulf.<br />
                        <br /> on <a href="http://docs.oxidemod.org/rust/" target="_blank" class="externalLink  rel=" nofollow">Oxide API docs for Rust</a> OnItemSplit and OnItemUpgrade still have the
                        same description<br />
                        <br /> (Also mentioning it to make sure im looking at the right page with up-to-date info) <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Yatta</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232607' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 19, 2016 at 4:43 PM">Jul 19, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232607' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/232607/permalink">#6</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-232608" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Yatta">
                            <aside>
                                <div class="attribution type">Yatta said: <a href="#post-232607" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">Hey, just a little heads to Wulf.<br />
                                        <br /> on <a href="http://docs.oxidemod.org/rust/" target="_blank" class="externalLink">Oxide API docs for Rust</a> OnItemSplit and OnItemUpgrade still have the
                                        same description<br />
                                        <br /> (Also mentioning it to make sure im looking at the right page with up-to-date info)</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>Yeah, I mentioned that I fixed it above, just haven&#039;t pushed yet. <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}" class="mceSmilieSprite mceSmilie2" alt=";)"
                            title="Wink    ;)" />
                        <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232608' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 19, 2016 at 4:45 PM">Jul 19, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232608' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/232608/permalink">#7</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-232619" class="message" data-author="Yatta">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Yatta" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto">Yatta</a>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml"> My bad, didnt know there was a update process. Thanks for fixing it <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}"
                            class="mceSmilieSprite mceSmilie1" alt=":)" title="Smile    :)" /><br />
                        <br /> I know im being a huge pain in the ass and I shouldnt ask about unrelated topics in a thread, but do you know how a server can spawn thousands of tress in a map in a
                        couple seconds at startup ? And is it possible to do the same thing from a plugin ? Im stuck with that - it prevents my mod/plugin to be released on a public server (takes more
                        than 15 minutes to plant the trees manually) which is a bummer after 2+ weeks of working on it ... Its a mod aiming to balance many aspects and players interactions of the game
                        including resources. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Yatta</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232619' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 19, 2016 at 4:54 PM">Jul 19, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232619' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/232619/permalink">#8</a>
                </div>
            </div>
        </div>
    </li>
    <li id="post-232699" class="message staff" data-author="Wulf">
        <div class="messageUserInfo">
            <div class="messageUserBlock">
                <div class="avatarHolder">
                    <span class="helper"></span>
                    <a class="avatar Avm" data-avatarhtml="true"><img src="{{ '/assets/styles/oxide/logo.og.png' | prepend: site.baseurl }}" width="96" height="96" alt="Wulf" /></a>
                </div>
                <h3 class="userText">
                    <a class="username" dir="auto" itemprop="name">Wulf</a>
                    <em class="userBanner bannerRed wrapped" itemprop="title"><span class="before"></span><strong>Community Admin</strong><span class="after"></span></em>
                </h3>
                <span class="arrow"></span>
            </div>
        </div>
        <div class="messageInfo primaryContent">
            <div class="messageContent">
                <article>
                    <blockquote class="messageText SelectQuoteContainer ugc baseHtml">
                        <div class="bbCodeBlock bbCodeQuote" data-author="Yatta">
                            <aside>
                                <div class="attribution type">Yatta said: <a href="#post-232619" class="AttributionLink">&uarr;</a>
                                </div>
                                <blockquote class="quoteContainer">
                                    <div class="quote">My bad, didnt know there was a update process. Thanks for fixing it <img src="{{ '/assets/styles/default/xenforo/clear.png' | prepend: site.baseurl }}"
                                            class="mceSmilieSprite mceSmilie1" alt=":)" title="Smile    :)" /><br />
                                        <br /> I know im being a huge pain in the ass and I shouldnt ask about unrelated topics in a thread, but do you know how a server can spawn thousands of tress
                                        in a map in a couple seconds at startup ? And is it possible to do the same thing from a plugin ? Im stuck with that - it prevents my mod/plugin to be released
                                        on a public server (takes more than 15 minutes to plant the trees manually) which is a bummer after 2+ weeks of working on it ... Its a mod aiming to balance
                                        many aspects and players interactions of the game including resources.</div>
                                    <div class="quoteExpand">Click to expand...</div>
                                </blockquote>
                            </aside>
                        </div>I&#039;m not really familiar with entity spawning like that, but I&#039;d recommend creating a new thread. <div class="messageTextEndMarker">&nbsp;</div>
                    </blockquote>
                </article>
            </div>
            <div class="messageMeta ToggleTriggerAnchor">
                <div class="privateControls">
                    <span class="item muted">
                        <span class="authorEnd"><a class="username author" dir="auto">Wulf</a>,</span>
                        <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232699' | prepend: site.baseurl }}" title="Permalink" class="datePermalink"><span class="DateTime"
                                title="Jul 19, 2016 at 8:53 PM">Jul 19, 2016</span></a>
                    </span>
                </div>
                <div class="publicControls">
                    <a href="{{ '/threads/prevent-looting-some-items-from-inventories.19683/#post-232699' | prepend: site.baseurl }}" title="Permalink"
                        class="item muted postNumber hashPermalink OverlayTrigger" data-href="posts/232699/permalink">#9</a>
                </div>
            </div>
        </div>
    </li>
</ol>
